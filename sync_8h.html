<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ebs-time: time/sync.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ebs-time<span id="projectnumber">&#160;0.3.3</span>
   </div>
   <div id="projectbrief">Time keeping and manipulation functions for embedded systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('sync_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a>  </div>
  <div class="headertitle"><div class="title">sync.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Time synchonization functions for embebedded systems.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;ds/avltree.h&gt;</code><br />
<code>#include &quot;<a class="el" href="time_8h_source.html">time.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for sync.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="sync_8h__incl.svg" width="551" height="256"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="sync_8h__dep__incl.svg" width="375" height="110"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="sync_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:struct_t_m___s_y_n_c___s_m__t" id="r_struct_t_m___s_y_n_c___s_m__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sync_8h.html#struct_t_m___s_y_n_c___s_m__t">TM_SYNC_SM_t</a></td></tr>
<tr class="separator:struct_t_m___s_y_n_c___s_m__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a18ef234d9074ddc69c22860303b946a9" id="r_a18ef234d9074ddc69c22860303b946a9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sync_8h.html#a18ef234d9074ddc69c22860303b946a9">TM_SYNC_STATE_PREINIT</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a18ef234d9074ddc69c22860303b946a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22fdf6fe552e9f9992451716e8e6b68b" id="r_a22fdf6fe552e9f9992451716e8e6b68b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sync_8h.html#a22fdf6fe552e9f9992451716e8e6b68b">TM_SYNC_STATE_IDLE</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a22fdf6fe552e9f9992451716e8e6b68b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a538a417d25ccaa6cbf6fc33e0f37c7f6" id="r_a538a417d25ccaa6cbf6fc33e0f37c7f6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sync_8h.html#a538a417d25ccaa6cbf6fc33e0f37c7f6">TM_SYNC_STATE_WAIT_HOST</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a538a417d25ccaa6cbf6fc33e0f37c7f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a296c28a81c59e20065ac8d695e94a3a3" id="r_a296c28a81c59e20065ac8d695e94a3a3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sync_8h.html#a296c28a81c59e20065ac8d695e94a3a3">TM_SYNC_STATE_WAIT_FOLLOW_UP</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a296c28a81c59e20065ac8d695e94a3a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5464ab835f2582881afe36596fa55554" id="r_a5464ab835f2582881afe36596fa55554"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sync_8h.html#a5464ab835f2582881afe36596fa55554">TM_SYNC_STATE_WAIT_DELAY_IN</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a5464ab835f2582881afe36596fa55554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ab15dd924aca07e954923ec8b1af341" id="r_a4ab15dd924aca07e954923ec8b1af341"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sync_8h.html#a4ab15dd924aca07e954923ec8b1af341">TM_SYNC_STATE_WAIT_DELAY_OUT</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a4ab15dd924aca07e954923ec8b1af341"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abb7f3c8f19e844952b6057619da95ae9" id="r_abb7f3c8f19e844952b6057619da95ae9"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="sync_8h.html#struct_t_m___s_y_n_c___s_m__t">TM_SYNC_SM_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sync_8h.html#abb7f3c8f19e844952b6057619da95ae9">tm_sync_sm_t</a></td></tr>
<tr class="separator:abb7f3c8f19e844952b6057619da95ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Time synchonization functions for embebedded systems. </p>
<p>The Time Synchronization implementation presented here is based on the synchronization elements of the IEEE 1588 Precision Time Protocol. The bulk of the IEEE 1588 specification is ignored to provide a bare minimum time synchronization implementation suitable for a reasonable degree of time synchronization (not high precision) on highly constrained platforms.</p>
<p>This implementation neither knows nor cares about the specifics of the transport used. Synchonization precision will be highly dependent on the stability and symmetry of the transport used. Due to its transport independent design, this implementation cannot take advantage of specialized PHYs intended for precision time synchronization such as PHYTER.</p>
<p>This implementation assumes that the system is able to propagate and maintain it's own time, and does so with the implementation included in this library (or one compatible with it).</p>
<p>This implementation also assumes that the following pieces of information are known to both the host and the device :</p><ul>
<li>epoch, as in <code>tm_epoch</code></li>
<li>resolution of the frac, as in <code>TIME_SYSTICKS_PER_SECOND</code></li>
</ul>
<p>Applications enabling this functionality must ensure TIME_ENABLE_SYNC is defined and non-zero. TM_BASE_ADDRESS as provided to <code>tm_init</code> should be known.</p>
<p>The following is the general synchronization process host-side applications must implement to use this interface:</p><ul>
<li>master must initiate the synchronization process by writing a timestamp to the appropriate UCDM registers.UCDM</li>
</ul>
<p>Utilization of this library is typically in one of three ways :</p>
<ul>
<li>Time Initialization</li>
<li>Ephemeral Time Synchronization</li>
<li>Continuous Time Synchronization</li>
</ul>
<p>Each approach is more complex than the last, and involves more system resources.</p>
<ol type="1">
<li><p class="startli">Time Initialization</p>
<p class="startli">This is the simplest means of utilizing this implementation. This kind of application requires the assumption that the system is perfectly capable of maintaining it's own clocks, once intialized to the correct time. This assumption is usually invalidated over long periods due to clock drift, and over even longer periods (years) due to leap seconds.</p>
</li>
<li><p class="startli">Ephemeral Time Synchronization</p>
<p class="startli">This is likely the optimal use of this implementation. In this kind of application, time is synchonized at specific 'safe' points of the application. In order to use this implementation, the host must know when the device is safely able to synchonize. This synchronization will hold until the next sychronization happens, after which the system is more or less reset to a known temporal state. At the next synchronization, any stored timstamps within the application should effectively be invalidated, or be offset by a degree equal to that of the offset synchonized.</p>
</li>
<li><p class="startli">Continuous Time Synchonization</p>
<p class="startli">This is the most complicated use of this implementation, with serious implications to system performance. When time is synchonized, this implementation will pass along the offset to all subsystems which have stored timestamps, and all of them must apply these offsets to all timestamps they store which require this precision. This kind of synchonization is likely to have dangerous consequences to scheduled events and temporally marked data streams.</p>
</li>
</ol>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="sync_8c.html" title="Time synchonization function implementation.">sync.c</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="sync_8h_source.html">sync.h</a>.</p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="struct_t_m___s_y_n_c___s_m__t" id="struct_t_m___s_y_n_c___s_m__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_t_m___s_y_n_c___s_m__t">&#9670;&#160;</a></span>TM_SYNC_SM_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct TM_SYNC_SM_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="sync_8h_source.html#l00116">116</a> of file <a class="el" href="sync_8h_source.html">sync.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a0b57aa10271a66f3dc936bba1d2f3830" name="a0b57aa10271a66f3dc936bba1d2f3830"></a>uint8_t</td>
<td class="fieldname">
state</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4808ff6c226e88e26247c48b2bb88f33" name="a4808ff6c226e88e26247c48b2bb88f33"></a><a class="el" href="time_8h.html#a6431d9bc028f3b054654b0b326ca6e97">tm_system_t</a></td>
<td class="fieldname">
t1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8fe8b24dbb001170e43c9a0430740307" name="a8fe8b24dbb001170e43c9a0430740307"></a><a class="el" href="time_8h.html#a6431d9bc028f3b054654b0b326ca6e97">tm_system_t</a></td>
<td class="fieldname">
t1p</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a33db5c20b257b5929a79f75b8f243f6d" name="a33db5c20b257b5929a79f75b8f243f6d"></a><a class="el" href="time_8h.html#a6431d9bc028f3b054654b0b326ca6e97">tm_system_t</a></td>
<td class="fieldname">
t2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6b90e426601fe4c3c55a519bf97868bb" name="a6b90e426601fe4c3c55a519bf97868bb"></a><a class="el" href="time_8h.html#a6431d9bc028f3b054654b0b326ca6e97">tm_system_t</a></td>
<td class="fieldname">
t2p</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a22fdf6fe552e9f9992451716e8e6b68b" name="a22fdf6fe552e9f9992451716e8e6b68b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22fdf6fe552e9f9992451716e8e6b68b">&#9670;&#160;</a></span>TM_SYNC_STATE_IDLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_SYNC_STATE_IDLE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sync_8h_source.html#l00107">107</a> of file <a class="el" href="sync_8h_source.html">sync.h</a>.</p>

</div>
</div>
<a id="a18ef234d9074ddc69c22860303b946a9" name="a18ef234d9074ddc69c22860303b946a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18ef234d9074ddc69c22860303b946a9">&#9670;&#160;</a></span>TM_SYNC_STATE_PREINIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_SYNC_STATE_PREINIT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sync_8h_source.html#l00106">106</a> of file <a class="el" href="sync_8h_source.html">sync.h</a>.</p>

</div>
</div>
<a id="a5464ab835f2582881afe36596fa55554" name="a5464ab835f2582881afe36596fa55554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5464ab835f2582881afe36596fa55554">&#9670;&#160;</a></span>TM_SYNC_STATE_WAIT_DELAY_IN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_SYNC_STATE_WAIT_DELAY_IN&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sync_8h_source.html#l00110">110</a> of file <a class="el" href="sync_8h_source.html">sync.h</a>.</p>

</div>
</div>
<a id="a4ab15dd924aca07e954923ec8b1af341" name="a4ab15dd924aca07e954923ec8b1af341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ab15dd924aca07e954923ec8b1af341">&#9670;&#160;</a></span>TM_SYNC_STATE_WAIT_DELAY_OUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_SYNC_STATE_WAIT_DELAY_OUT&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sync_8h_source.html#l00111">111</a> of file <a class="el" href="sync_8h_source.html">sync.h</a>.</p>

</div>
</div>
<a id="a296c28a81c59e20065ac8d695e94a3a3" name="a296c28a81c59e20065ac8d695e94a3a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a296c28a81c59e20065ac8d695e94a3a3">&#9670;&#160;</a></span>TM_SYNC_STATE_WAIT_FOLLOW_UP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_SYNC_STATE_WAIT_FOLLOW_UP&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sync_8h_source.html#l00109">109</a> of file <a class="el" href="sync_8h_source.html">sync.h</a>.</p>

</div>
</div>
<a id="a538a417d25ccaa6cbf6fc33e0f37c7f6" name="a538a417d25ccaa6cbf6fc33e0f37c7f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a538a417d25ccaa6cbf6fc33e0f37c7f6">&#9670;&#160;</a></span>TM_SYNC_STATE_WAIT_HOST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_SYNC_STATE_WAIT_HOST&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sync_8h_source.html#l00108">108</a> of file <a class="el" href="sync_8h_source.html">sync.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="abb7f3c8f19e844952b6057619da95ae9" name="abb7f3c8f19e844952b6057619da95ae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb7f3c8f19e844952b6057619da95ae9">&#9670;&#160;</a></span>tm_sync_sm_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="sync_8h.html#struct_t_m___s_y_n_c___s_m__t">TM_SYNC_SM_t</a> <a class="el" href="sync_8h.html#abb7f3c8f19e844952b6057619da95ae9">tm_sync_sm_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_f6227287712d84441d1f97cc74cea9a5.html">time</a></li><li class="navelem"><a class="el" href="sync_8h.html">sync.h</a></li>
    <li class="footer">Generated on Thu Jan 16 2025 19:55:30 for ebs-time by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
