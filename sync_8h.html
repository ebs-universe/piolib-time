<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ebs-time: time/sync.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ebs-time
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">Time keeping and manipulation functions for embedded systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('sync_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sync.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Time synchonization functions for embebedded systems.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;ds/avltree.h&gt;</code><br />
<code>#include &quot;<a class="el" href="time_8h_source.html">time.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for sync.h:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="sync_8h__incl.svg" width="416" height="262"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="sync_8h__dep__incl.svg" width="230" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="sync_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_t_m___s_y_n_c___s_m__t.html">TM_SYNC_SM_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a18ef234d9074ddc69c22860303b946a9"><td class="memItemLeft" align="right" valign="top"><a id="a18ef234d9074ddc69c22860303b946a9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TM_SYNC_STATE_PREINIT</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a18ef234d9074ddc69c22860303b946a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22fdf6fe552e9f9992451716e8e6b68b"><td class="memItemLeft" align="right" valign="top"><a id="a22fdf6fe552e9f9992451716e8e6b68b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TM_SYNC_STATE_IDLE</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a22fdf6fe552e9f9992451716e8e6b68b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a538a417d25ccaa6cbf6fc33e0f37c7f6"><td class="memItemLeft" align="right" valign="top"><a id="a538a417d25ccaa6cbf6fc33e0f37c7f6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TM_SYNC_STATE_WAIT_HOST</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a538a417d25ccaa6cbf6fc33e0f37c7f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5464ab835f2582881afe36596fa55554"><td class="memItemLeft" align="right" valign="top"><a id="a5464ab835f2582881afe36596fa55554"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TM_SYNC_STATE_WAIT_DELAY_IN</b>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a5464ab835f2582881afe36596fa55554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ab15dd924aca07e954923ec8b1af341"><td class="memItemLeft" align="right" valign="top"><a id="a4ab15dd924aca07e954923ec8b1af341"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TM_SYNC_STATE_WAIT_DELAY_OUT</b>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a4ab15dd924aca07e954923ec8b1af341"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abb7f3c8f19e844952b6057619da95ae9"><td class="memItemLeft" align="right" valign="top"><a id="abb7f3c8f19e844952b6057619da95ae9"></a>
typedef struct <a class="el" href="struct_t_m___s_y_n_c___s_m__t.html">TM_SYNC_SM_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>tm_sync_sm_t</b></td></tr>
<tr class="separator:abb7f3c8f19e844952b6057619da95ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af6e941dead4a29cea2fa67a097cf2a50"><td class="memItemLeft" align="right" valign="top"><a id="af6e941dead4a29cea2fa67a097cf2a50"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>tm_sync_init</b> (uint16_t ucdm_next_address)</td></tr>
<tr class="separator:af6e941dead4a29cea2fa67a097cf2a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94cb48a6c8e97edcb35a5cd4fb9bb058"><td class="memItemLeft" align="right" valign="top"><a id="a94cb48a6c8e97edcb35a5cd4fb9bb058"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>tm_sync_request_host</b> (void)</td></tr>
<tr class="separator:a94cb48a6c8e97edcb35a5cd4fb9bb058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39163d1008e141876374703577331c48"><td class="memItemLeft" align="right" valign="top"><a id="a39163d1008e141876374703577331c48"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>tm_sync_handler</b> (uint16_t addr)</td></tr>
<tr class="separator:a39163d1008e141876374703577331c48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a834c2c9495e1144959556e6ade22218e"><td class="memItemLeft" align="right" valign="top"><a id="a834c2c9495e1144959556e6ade22218e"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>tm_sync_current_to_rtc</b> (void)</td></tr>
<tr class="separator:a834c2c9495e1144959556e6ade22218e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab1a8a9181d9d011c6f33ce3c6d87489"><td class="memItemLeft" align="right" valign="top"><a id="aab1a8a9181d9d011c6f33ce3c6d87489"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>tm_sync_current_from_rtc</b> (void)</td></tr>
<tr class="separator:aab1a8a9181d9d011c6f33ce3c6d87489"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a99c0fcd3fc731bba88bba4bdb66ef792"><td class="memItemLeft" align="right" valign="top"><a id="a99c0fcd3fc731bba88bba4bdb66ef792"></a>
avlt_node_t&#160;</td><td class="memItemRight" valign="bottom"><b>tm_avlt_sync_handler_node</b></td></tr>
<tr class="separator:a99c0fcd3fc731bba88bba4bdb66ef792"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Time synchonization functions for embebedded systems. </p>
<p>The Time Synchronization implementation presented here is based on the synchronization elements of the IEEE 1588 Precision Time Protocol. The bulk of the IEEE 1588 specification is ignored to provide a bare minimum time synchronization implementation suitable for a reasonable degree of time synchronization (not high precision) on highly constrained platforms.</p>
<p>This implementation neither knows nor cares about the specifics of the transport used. Synchonization precision will be highly dependent on the stability and symmetry of the transport used. Due to its transport independent design, this implementation cannot take advantage of specialized PHYs intended for precision time synchronization such as PHYTER.</p>
<p>This implementation assumes that the system is able to propagate and maintain it's own time, and does so with the implementation included in this library (or one compatible with it).</p>
<p>This implementation also assumes that the following pieces of information are known to both the host and the device :</p><ul>
<li>epoch, as in <code>tm_epoch</code></li>
<li>resolution of the frac, as in <code>TIME_SYSTICKS_PER_SECOND</code></li>
</ul>
<p>Utilization of this library is typically in one of three ways :</p>
<ul>
<li>Time Initialization</li>
<li>Ephemeral Time Synchronization</li>
<li>Continuous Time Synchronization</li>
</ul>
<p>Each approach is more complex than the last, and involves more system resources.</p>
<ol type="1">
<li><p class="startli">Time Initialization</p>
<p class="startli">This is the simplest means of utilizing this implementation. This kind of application requires the assumption that the system is perfectly capable of maintaining it's own clocks, once intialized to the correct time. This assumption is usually invalidated over long periods due to clock drift, and over even longer periods (years) due to leap seconds.</p>
</li>
<li><p class="startli">Ephemeral Time Synchronization</p>
<p class="startli">This is likely the optimal use of this implementation. In this kind of application, time is synchonized at specific 'safe' points of the application. In order to use this implementation, the host must know when the device is safely able to synchonize. This synchronization will hold until the next sychronization happens, after which the system is more or less reset to a known state as far as temporal state is concerned. At the next synchronization, any stored timstamps within the application should effectively be invalidated, or be offset by a degree equal to that of the offset synchonized.</p>
</li>
<li><p class="startli">Continuous Time Synchonization</p>
<p class="startli">This is the most complicated use of this implementation, with serious implications to system performance. When time is synchonized, this implementation will pass along the offset to all subsystems which have stored timestamps, and all of them must apply these offsets for all timestamps they have which require this precision. This kind of synchonization is likely to have dangerous consequences to scheduled events and temporally marked data streams.</p>
</li>
</ol>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="sync_8c.html" title="Time synchonization function implementations.">sync.c</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="sync_8h_source.html">sync.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_f6227287712d84441d1f97cc74cea9a5.html">time</a></li><li class="navelem"><a class="el" href="sync_8h.html">sync.h</a></li>
    <li class="footer">Generated on Wed May 29 2024 15:19:38 for ebs-time by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
